let restaurant;var map;"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(function(e){console.log("ServiceWorker registration successful")},function(e){console.log("ServiceWorker registration failed")}),window.initMap=(()=>{fetchRestaurantFromURL((e,t)=>{e?console.error(e):(self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:t.latlng,scrollwheel:!1}),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.map))})}),fetchRestaurantFromURL=(e=>{if(self.restaurant)return void e(null,self.restaurant);const t=getParameterByName("id");t?DBHelper.fetchRestaurantById(t,(t,a)=>{self.restaurant=a,a?(fillRestaurantHTML(),e(null,a)):console.error(t)}):(error="No restaurant id in URL",e(error,null))}),fillRestaurantHTML=((e=self.restaurant)=>{const t=document.getElementById("restaurant-name");t.innerHTML=e.name,t.setAttribute("aria-label",e.name);const a=document.getElementById("restaurant-address");a.innerHTML=e.address,a.setAttribute("aria-label",e.address);const n=document.getElementById("small-img");n.media="(max-width: 420px)",n.setAttribute("data-srcset",DBHelper.smallImageUrlForRestaurant(e)+" 420w");const r=document.getElementById("medium-img");r.media="(max-width: 768px)",r.setAttribute("data-srcset",DBHelper.mediumImageUrlForRestaurant(e)+" 768w");const l=document.getElementById("restaurant-img");l.className="restaurant-img lazyload",l.src=DBHelper.tinyImageUrlForRestaurant(e),l.setAttribute("data-src",DBHelper.imageUrlForRestaurant(e)),l.alt=e.name;const s=document.getElementById("restaurant-cuisine");s.innerHTML=e.cuisine_type,s.setAttribute("aria-label",e.cuisine_type);const i=document.getElementById("restaurant-cuisine"),o=!(!e.is_favorite||"true"!==e.is_favorite.toString()),d=document.createElement("div"),c=document.createElement("button");c.className="fav",c.innerHTML=o?" &#9829;":" &#9825;",c.setAttribute("onclick","DBHelper.setFavorite()"),d.append(c),i.append(d),e.operating_hours&&fillRestaurantHoursHTML();const m=self.restaurant.id;DBHelper.fetchReviews(m,(e,t)=>{self.reviews=t,fillReviewsHTML(t)})}),fillRestaurantHoursHTML=((e=self.restaurant.operating_hours)=>{const t=document.getElementById("restaurant-hours");for(let a in e){const n=document.createElement("tr"),r=document.createElement("td");r.innerHTML=a,r.setAttribute("aria-label",a),n.appendChild(r);const l=document.createElement("td");l.innerHTML=e[a],l.setAttribute("aria-label",e[a]),n.appendChild(l),t.appendChild(n)}}),fillReviewsHTML=((e=self.restaurant.reviews)=>{const t=document.getElementById("reviews-container"),a=document.createElement("h2");if(a.innerHTML="Reviews",t.appendChild(a),!e){const e=document.createElement("p");return e.innerHTML="No reviews yet!",void t.appendChild(e)}const n=document.getElementById("reviews-list");e.forEach(e=>{n.appendChild(createReviewHTML(e))}),t.appendChild(n)}),createReviewHTML=(e=>{const t=document.createElement("li"),a=document.createElement("div"),n=document.createElement("div"),r=document.createElement("p");r.className="name",a.className="header",n.className="content",r.innerHTML=e.name,r.setAttribute("aria-label",e.name),t.appendChild(a),t.appendChild(r),a.appendChild(r);const l=document.createElement("p");l.className="date",l.innerHTML="Posted on "+new Date(e.updatedAt).toLocaleDateString("en-US"),l.setAttribute("aria-label","Posted on "+new Date(e.updatedAt).toLocaleDateString("en-US")),t.appendChild(l),a.appendChild(l);const s=document.createElement("p");s.className="rating",s.innerHTML=`Rating: ${e.rating}`,s.setAttribute("aria-label",`Rating: ${e.rating}`),t.appendChild(n),t.appendChild(s),n.appendChild(s);const i=document.createElement("p");return i.className="comments",i.innerHTML=e.comments,i.setAttribute("aria-label",e.comments),t.appendChild(i),n.appendChild(i),t}),fillBreadcrumb=((e=self.restaurant)=>{const t=document.getElementById("breadcrumb"),a=document.createElement("li");a.innerHTML=e.name,t.appendChild(a)}),getParameterByName=((e,t)=>{t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const a=new RegExp(`[?&]${e}(=([^&#]*)|&|#|$)`).exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null});